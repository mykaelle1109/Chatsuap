{% extends "base.html" %} {% block title %}ChatSUAP - Professor{% endblock %} {%
block content %}
<div class="chat-window" id="chat">
  <div class="chat-input">
    <input id="userInput" type="text" placeholder="Digite sua mensagem..." />
    <button onclick="sendMessage()">Enviar</button>
  </div>
</div>

<script>
  async function sendMessage() {
    const input = document.getElementById("userInput");
    const chat = document.getElementById("chat");
    const message = input.value.trim();

    if (message === "") return;

    const userMsg = document.createElement("div");
    userMsg.className = "message user";
    userMsg.textContent = message;
    chat.appendChild(userMsg);

    input.value = "";
    chat.scrollTop = chat.scrollHeight;

    try {
      const response = await fetch("/chat", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message, role: "professor" }),
      });

      const data = await response.json();

      const botMsg = document.createElement("div");
      botMsg.className = "message bot";
      botMsg.textContent = data.response;
      chat.appendChild(botMsg);

      chat.scrollTop = chat.scrollHeight;
    } catch (error) {
      console.error("Erro:", error);
    }
  }
</script>
{% endblock %}
